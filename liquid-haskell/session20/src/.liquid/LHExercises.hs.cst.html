<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>src/LHExercises.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum>  1: </span><a class=annot href="#"><span class=annottext>{VV##2169 : GHC.Types.Module | $k_##2170}</span>
</a><span class=hs-linenum>  2: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>LHExercises</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>  3: </span>
<span class=hs-linenum>  4: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Maybe</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>Maybe</span>
<span class=hs-linenum>  5: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Tuple</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>Tuple</span>
<span class=hs-linenum>  6: </span>
<span class=hs-linenum>  7: </span><span class='hs-comment'>-- import Prelude</span>
<span class=hs-linenum>  8: </span>
<span class=hs-linenum>  9: </span><span class='hs-comment'>-- Exercise 1:  Define a Skew heap in Liquid Haskell and implement</span>
<span class=hs-linenum> 10: </span><span class='hs-comment'>-- and verify its operation join, joining two skew heaps </span>
<span class=hs-linenum> 11: </span><span class='hs-comment'>-- into one (see the dafny file to inspire you)</span>
<span class=hs-linenum> 12: </span>
<span class=hs-linenum> 13: </span>
<span class=hs-linenum> 14: </span><span class='hs-comment'>-- Exercise 2: Specify and define in Liquid Haskell a quicksort algorithm ensuring</span>
<span class=hs-linenum> 15: </span><span class='hs-comment'>-- an ordered output list and having the same set of elements as the input list</span>
<span class=hs-linenum> 16: </span>
<span class=hs-linenum> 17: </span>
<span class=hs-linenum> 18: </span><span class='hs-comment'>-- Exercise 3: Complete the exercise 7.10 of the LH book about the function</span>
<span class=hs-linenum> 19: </span><span class='hs-comment'>-- matFromList      :: [[a]] -&gt; Maybe (Matrix a)</span>
<span class=hs-linenum> 20: </span>
<span class=hs-linenum> 21: </span><span class='hs-comment'>-- Exercise 4: Complete the exercise 7.12 of the LH book about the function</span>
<span class=hs-linenum> 22: </span><span class='hs-comment'>-- {-@ transpose :: m:Matrix a -&gt; MatrixN a (mCol m) (mRow m) @-}</span>
<span class=hs-linenum> 23: </span>
<span class=hs-linenum> 24: </span>
<span class=hs-linenum> 25: </span><span class='hs-comment'>-- Exercise 5: Read Chapter 9 of the LH book about lazy queues and do the exercises &lt;-- MINE  # ASSIGNMENT</span>
<span class=hs-linenum> 26: </span><span class='hs-comment'>-- 9.3 and 9.4</span>
<span class=hs-linenum> 27: </span>
<span class=hs-linenum> 28: </span>
<span class=hs-linenum> 29: </span><span class='hs-comment'>-- Exercise 6: Read Chapter 9 of the LH book about lazy queues and do the exercises</span>
<span class=hs-linenum> 30: </span><span class='hs-comment'>-- 9.5 and 9.6</span>
<span class=hs-linenum> 31: </span>
<span class=hs-linenum> 32: </span>
<span class=hs-linenum> 33: </span><span class='hs-comment'>-- For exercises 5 and 6, you can use the following definitions:</span>
<span class=hs-linenum> 34: </span>
<span class=hs-linenum> 35: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SL</span> <span class='hs-layout'>{</span> <span class='hs-varid'>size</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span><span class='hs-layout'>,</span> <span class='hs-varid'>elems</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-layout'>}</span>
<span class=hs-linenum> 36: </span>
<span class=hs-linenum> 37: </span><span class='hs-comment'>-- {-@ size :: q:SList a -&gt; {v:Nat | v = size q} @-}</span>
<span class=hs-linenum> 38: </span>
<span class=hs-linenum> 39: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>realSize</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 40: </span><span class='hs-definition'>realSize</span>      <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum> 41: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##498:[a] -&gt; {VV : GHC.Types.Int | VV == LHExercises.realSize lq_tmp$x##498}</span><span class='hs-definition'>realSize</span></a> <span class='hs-conid'>[]</span>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##524 : GHC.Prim.Int# | lq_tmp$x##524 == 0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum> 42: </span><span class='hs-definition'>realSize</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##570 : GHC.Types.Int | lq_tmp$x##570 == (lq_anf$##7205759403792801722##d270 : int)}</span><span class='hs-num'>1</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##579 : GHC.Types.Int | lq_tmp$x##579 == LHExercises.realSize xs##aXJ}</span><span class='hs-varid'>realSize</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##590 : [a] | lq_tmp$x##590 == xs##aXJ
                       &amp;&amp; len lq_tmp$x##590 &gt;= 0}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum> 43: </span><span class='hs-comment'>-- \end{code}</span>
<span class=hs-linenum> 44: </span>
<span class=hs-linenum> 45: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>data</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SL</span> <span class='hs-layout'>{</span>
<span class=hs-linenum> 46: </span>       <span class='hs-varid'>size</span>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Nat</span> 
<span class=hs-linenum> 47: </span>     <span class='hs-layout'>,</span> <span class='hs-varid'>elems</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>realSize</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>size</span><span class='hs-layout'>}</span>
<span class=hs-linenum> 48: </span>     <span class='hs-layout'>}</span>
<span class=hs-linenum> 49: </span><span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 50: </span>
<span class=hs-linenum> 51: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>SListN</span> <span class='hs-varid'>a</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>size</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>N</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 52: </span>
<span class=hs-linenum> 53: </span>
<span class=hs-linenum> 54: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>NEList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>size</span> <span class='hs-varid'>v</span> <span class='hs-varop'>&gt;</span> <span class='hs-num'>0</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 55: </span>
<span class=hs-linenum> 56: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>SListLE</span> <span class='hs-varid'>a</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>size</span> <span class='hs-varid'>v</span> <span class='hs-varop'>&lt;=</span> <span class='hs-conid'>N</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 57: </span>
<span class=hs-linenum> 58: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>nil</span>          <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SListN</span> <span class='hs-varid'>a</span> <span class='hs-num'>0</span>  <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 59: </span><span class='hs-definition'>nil</span>              <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 60: </span><a class=annot href="#"><span class=annottext>forall a .
{VV##0 : (LHExercises.SList a) | LHExercises.size VV##0 == 0}</span><span class='hs-definition'>nil</span></a>              <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SL</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##616 : GHC.Types.Int | lq_tmp$x##616 == (lq_anf$##7205759403792801725##d273 : int)}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {lq_tmp$x##624 : [a]&lt;\lq_tmp$x##625 VV -&gt; {lq_tmp$x##623 : a&lt;p lq_tmp$x##625&gt; | true}&gt; | LHExercises.realSize lq_tmp$x##624 == 0
                                                                                               &amp;&amp; len lq_tmp$x##624 == 0} | VV == GHC.Types.[]}</span><span class='hs-conid'>[]</span></a>
<span class=hs-linenum> 61: </span>
<span class=hs-linenum> 62: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>cons</span>         <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span><span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SListN</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>{size xs + 1}</span>   <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 63: </span><span class='hs-definition'>cons</span>             <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 64: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##734:a -&gt; lq_tmp$x##735:(LHExercises.SList a) -&gt; {VV##0 : (LHExercises.SList a) | LHExercises.size VV##0 == LHExercises.size lq_tmp$x##735 + 1}</span><span class='hs-definition'>cons</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>SL</span> <span class='hs-varid'>n</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      lq_tmp$x##834:{lq_tmp$x##824 : GHC.Types.Int | lq_tmp$x##824 &gt;= 0} -&gt; lq_tmp$x##835:{lq_tmp$x##828 : [a] | LHExercises.realSize lq_tmp$x##828 == lq_tmp$x##834} -&gt; {lq_tmp$x##830 : (LHExercises.SList a) | LHExercises.elems lq_tmp$x##830 == lq_tmp$x##835
                                                                                                                                                                                                                  &amp;&amp; LHExercises.size lq_tmp$x##830 == lq_tmp$x##834} | VV == LHExercises.SL}</span><span class='hs-conid'>SL</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##788 : GHC.Types.Int | lq_tmp$x##788 == n##aXL + lq_anf$##7205759403792801734##d27c}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##791 : GHC.Types.Int | lq_tmp$x##791 == n##aXL
                                 &amp;&amp; lq_tmp$x##791 &gt;= 0}</span><span class='hs-varid'>n</span></a><span class='hs-varop'>+</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##772 : GHC.Types.Int | lq_tmp$x##772 == (lq_anf$##7205759403792801733##d27b : int)}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##802 : [{lq_tmp$x##812 : a | $k_##811[VV##810:=lq_tmp$x##812][lq_tmp$x##806:=x##aXK][lq_tmp$x##807:=xs##aXM]}]&lt;\lq_tmp$x##809 VV -&gt; {lq_tmp$x##812 : a | $k_##814[VV##813:=lq_tmp$x##812][lq_tmp$x##806:=x##aXK][lq_tmp$x##807:=xs##aXM][lq_tmp$x##815:=lq_tmp$x##809]}&gt; | LHExercises.realSize lq_tmp$x##802 == 1 + LHExercises.realSize xs##aXM
                                                                                                                                                                                                                                                                                     &amp;&amp; head lq_tmp$x##802 == x##aXK
                                                                                                                                                                                                                                                                                     &amp;&amp; len lq_tmp$x##802 == 1 + len xs##aXM
                                                                                                                                                                                                                                                                                     &amp;&amp; tail lq_tmp$x##802 == xs##aXM}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##817 : a | lq_tmp$x##817 == x##aXK}</span><span class='hs-varid'>x</span></a><span class='hs-conop'>:</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##821 : [a] | lq_tmp$x##821 == xs##aXM
                       &amp;&amp; LHExercises.realSize lq_tmp$x##821 == n##aXL
                       &amp;&amp; len lq_tmp$x##821 &gt;= 0}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 65: </span>
<span class=hs-linenum> 66: </span>
<span class=hs-linenum> 67: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>tl</span>           <span class='hs-keyglyph'>::</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span><span class='hs-conid'>NEList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SListN</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>{size xs - 1}</span>  <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 68: </span><span class='hs-definition'>tl</span>              <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 69: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##914:{VV##0 : (LHExercises.SList a) | LHExercises.size VV##0 &gt; 0} -&gt; {VV##0 : (LHExercises.SList a) | LHExercises.size VV##0 == LHExercises.size lq_tmp$x##914 - 1}</span><span class='hs-definition'>tl</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>SL</span> <span class='hs-varid'>n</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      lq_tmp$x##1059:{lq_tmp$x##1049 : GHC.Types.Int | lq_tmp$x##1049 &gt;= 0} -&gt; lq_tmp$x##1060:{lq_tmp$x##1053 : [a] | LHExercises.realSize lq_tmp$x##1053 == lq_tmp$x##1059} -&gt; {lq_tmp$x##1055 : (LHExercises.SList a) | LHExercises.elems lq_tmp$x##1055 == lq_tmp$x##1060
                                                                                                                                                                                                                          &amp;&amp; LHExercises.size lq_tmp$x##1055 == lq_tmp$x##1059} | VV == LHExercises.SL}</span><span class='hs-conid'>SL</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1043 : GHC.Types.Int | lq_tmp$x##1043 == n##aXN - lq_anf$##7205759403792801749##d27r}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##1046 : GHC.Types.Int | lq_tmp$x##1046 == n##aXN
                                  &amp;&amp; lq_tmp$x##1046 &gt;= 0}</span><span class='hs-varid'>n</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##1027 : GHC.Types.Int | lq_tmp$x##1027 == (lq_anf$##7205759403792801748##d27q : int)}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1069 : [a] | lq_tmp$x##1069 == xs##aXO
                        &amp;&amp; len lq_tmp$x##1069 &gt;= 0}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum> 70: </span>
<span class=hs-linenum> 71: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>hd</span>           <span class='hs-keyglyph'>::</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span><span class='hs-conid'>NEList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 72: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1072:{VV##0 : (LHExercises.SList a) | LHExercises.size VV##0 &gt; 0} -&gt; a</span><span class='hs-definition'>hd</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>SL</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1182 : a | lq_tmp$x##1182 == x##aXP}</span><span class='hs-varid'>x</span></a> 
<span class=hs-linenum> 73: </span>
<span class=hs-linenum> 74: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Queue</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Q</span>  <span class='hs-layout'>{</span> <span class='hs-varid'>front</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 75: </span>                  <span class='hs-layout'>,</span> <span class='hs-varid'>back</span>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 76: </span>                  <span class='hs-layout'>}</span>
<span class=hs-linenum> 77: </span>
<span class=hs-linenum> 78: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>data</span> <span class='hs-conid'>Queue</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Q</span> <span class='hs-layout'>{</span>
<span class=hs-linenum> 79: </span>      <span class='hs-varid'>front</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> 
<span class=hs-linenum> 80: </span>   <span class='hs-layout'>,</span>  <span class='hs-varid'>back</span>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SListLE</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-varid'>size</span> <span class='hs-varid'>front</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 81: </span>   <span class='hs-layout'>}</span>
<span class=hs-linenum> 82: </span><span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 83: </span>
<span class=hs-linenum> 84: </span><span class='hs-comment'>-- Exercise 9.3</span>
<span class=hs-linenum> 85: </span>
<span class=hs-linenum> 86: </span><span class='hs-comment'>-- Write a measure to describe the queue size</span>
<span class=hs-linenum> 87: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>qsize</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 88: </span><span class='hs-definition'>qsize</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Queue</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum> 89: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##2101:(LHExercises.Queue a) -&gt; {VV : GHC.Types.Int | VV == LHExercises.qsize lq_tmp$x##2101}</span><span class='hs-definition'>qsize</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Q</span> <span class='hs-varid'>f</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2132 : GHC.Types.Int | lq_tmp$x##2132 == LHExercises.size f##aXQ
                                  &amp;&amp; lq_tmp$x##2132 &gt;= 0}</span><span class='hs-varid'>size</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2139 : (LHExercises.SList a) | lq_tmp$x##2139 == f##aXQ}</span><span class='hs-varid'>f</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2143 : GHC.Types.Int | lq_tmp$x##2143 == LHExercises.size b##aXR
                                  &amp;&amp; lq_tmp$x##2143 &gt;= 0}</span><span class='hs-varid'>size</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2150 : (LHExercises.SList a) | lq_tmp$x##2150 == b##aXR
                                          &amp;&amp; LHExercises.size lq_tmp$x##2150 &lt;= LHExercises.size f##aXQ}</span><span class='hs-varid'>b</span></a>
<span class=hs-linenum> 90: </span>
<span class=hs-linenum> 91: </span><span class='hs-comment'>-- Use it to complete the definition of QueueN</span>
<span class=hs-linenum> 92: </span>
<span class=hs-linenum> 93: </span><span class='hs-comment'>-- | Queues of size `N`</span>
<span class=hs-linenum> 94: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>QueueN</span> <span class='hs-varid'>a</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>Queue</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>qsize</span> <span class='hs-varid'>v</span> <span class='hs-varop'>==</span> <span class='hs-conid'>N</span> <span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 95: </span>
<span class=hs-linenum> 96: </span><span class='hs-comment'>-- ############</span>
<span class=hs-linenum> 97: </span><span class='hs-comment'>-- start Victor</span>
<span class=hs-linenum> 98: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>makeq</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>f</span><span class='hs-conop'>:</span><span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-conop'>:</span><span class='hs-conid'>SListLE</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>{size f + 1}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>QueueN</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>{size f + size b}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 99: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1374:(LHExercises.SList a) -&gt; lq_tmp$x##1375:{VV##0 : (LHExercises.SList a) | LHExercises.size VV##0 &lt;= LHExercises.size lq_tmp$x##1374 + 1} -&gt; {VV##0 : (LHExercises.Queue a) | LHExercises.qsize VV##0 == LHExercises.size lq_tmp$x##1374 + LHExercises.size lq_tmp$x##1375}</span><span class='hs-definition'>makeq</span></a> <a class=annot href="#"><span class=annottext>(LHExercises.SList a)</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{VV##0 : (LHExercises.SList a) | LHExercises.size VV##0 &lt;= LHExercises.size f##aXS + 1}</span><span class='hs-varid'>b</span></a>
<span class=hs-linenum>100: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1380 : GHC.Types.Int | lq_tmp$x##1380 == LHExercises.size b##aXT
                                  &amp;&amp; lq_tmp$x##1380 &gt;= 0}</span><span class='hs-varid'>size</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1387 : (LHExercises.SList a) | lq_tmp$x##1387 == b##aXT
                                          &amp;&amp; LHExercises.size lq_tmp$x##1387 &lt;= LHExercises.size f##aXS + 1}</span><span class='hs-varid'>b</span></a> <span class='hs-varop'>&lt;=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1391 : GHC.Types.Int | lq_tmp$x##1391 == LHExercises.size f##aXS
                                  &amp;&amp; lq_tmp$x##1391 &gt;= 0}</span><span class='hs-varid'>size</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1398 : (LHExercises.SList a) | lq_tmp$x##1398 == f##aXS}</span><span class='hs-varid'>f</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      lq_tmp$x##1492:(LHExercises.SList a) -&gt; lq_tmp$x##1493:{lq_tmp$x##1487 : (LHExercises.SList a) | LHExercises.size lq_tmp$x##1487 &lt;= LHExercises.size lq_tmp$x##1492} -&gt; {lq_tmp$x##1489 : (LHExercises.Queue a) | LHExercises.back lq_tmp$x##1489 == lq_tmp$x##1493
                                                                                                                                                                                                                        &amp;&amp; LHExercises.front lq_tmp$x##1489 == lq_tmp$x##1492
                                                                                                                                                                                                                        &amp;&amp; LHExercises.qsize lq_tmp$x##1489 == LHExercises.size lq_tmp$x##1492 + LHExercises.size lq_tmp$x##1493} | VV == LHExercises.Q}</span><span class='hs-conid'>Q</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1498 : (LHExercises.SList a) | lq_tmp$x##1498 == f##aXS}</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1500 : (LHExercises.SList a) | lq_tmp$x##1500 == b##aXT
                                          &amp;&amp; LHExercises.size lq_tmp$x##1500 &lt;= LHExercises.size f##aXS + 1}</span><span class='hs-varid'>b</span></a>
<span class=hs-linenum>101: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1457 : (LHExercises.SList {lq_tmp$x##1460 : a | $k_##1459[VV##1458:=lq_tmp$x##1460]}) | LHExercises.size lq_tmp$x##1457 == 0}</span><span class='hs-conid'>Q</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1439 : (LHExercises.SList {lq_tmp$x##1448 : a | $k_##1447[VV##1446:=lq_tmp$x##1448][lq_tmp$x##1443:=f##aXS][lq_tmp$x##1444:=b##aXT][lq_tmp$x##1445:=lq_anf$##7205759403792801772##d27O]}) | LHExercises.size lq_tmp$x##1439 == (LHExercises.size f##aXS + LHExercises.size b##aXT) + LHExercises.size lq_anf$##7205759403792801772##d27O}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>rot</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1450 : (LHExercises.SList a) | lq_tmp$x##1450 == f##aXS}</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1452 : (LHExercises.SList a) | lq_tmp$x##1452 == b##aXT
                                          &amp;&amp; LHExercises.size lq_tmp$x##1452 &lt;= LHExercises.size f##aXS + 1}</span><span class='hs-varid'>b</span></a> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##1427 : (LHExercises.SList a) | LHExercises.size lq_tmp$x##1427 == 0} | VV == LHExercises.nil}</span><span class='hs-varid'>nil</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##1457 : (LHExercises.SList a) | LHExercises.size lq_tmp$x##1457 == 0} | VV == LHExercises.nil}</span><span class='hs-varid'>nil</span></a>
<span class=hs-linenum>102: </span>
<span class=hs-linenum>103: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>rot</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>f</span><span class='hs-conop'>:</span><span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-conop'>:</span><span class='hs-conid'>SListN</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>{size f + 1}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>acc</span><span class='hs-conop'>:</span><span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{v:</span><span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| size v = size f + size b + size acc }</span> <span class='hs-varop'>/</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>size</span> <span class='hs-varid'>f</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>104: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1187:(LHExercises.SList a) -&gt; lq_tmp$x##1188:{VV##0 : (LHExercises.SList a) | LHExercises.size VV##0 == LHExercises.size lq_tmp$x##1187 + 1} -&gt; lq_tmp$x##1189:(LHExercises.SList a) -&gt; {v : (LHExercises.SList a) | LHExercises.size v == (LHExercises.size lq_tmp$x##1187 + LHExercises.size lq_tmp$x##1188) + LHExercises.size lq_tmp$x##1189}</span><span class='hs-definition'>rot</span></a> <a class=annot href="#"><span class=annottext>(LHExercises.SList a)</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{VV##0 : (LHExercises.SList a) | LHExercises.size VV##0 == LHExercises.size f##aXU + 1}</span><span class='hs-varid'>b</span></a> <a class=annot href="#"><span class=annottext>(LHExercises.SList a)</span><span class='hs-varid'>acc</span></a>
<span class=hs-linenum>105: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1196 : GHC.Types.Int | lq_tmp$x##1196 == LHExercises.size f##aXU
                                  &amp;&amp; lq_tmp$x##1196 &gt;= 0}</span><span class='hs-varid'>size</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1203 : (LHExercises.SList a) | lq_tmp$x##1203 == f##aXU}</span><span class='hs-varid'>f</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1208 : GHC.Types.Int | lq_tmp$x##1208 == (lq_anf$##7205759403792801757##d27z : int)}</span><span class='hs-num'>0</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1352 : a | $k_##1351[VV##1350:=lq_tmp$x##1352][lq_tmp$x##1349:=b##aXV]}</span><span class='hs-varid'>hd</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1354 : (LHExercises.SList a) | lq_tmp$x##1354 == b##aXV
                                          &amp;&amp; LHExercises.size lq_tmp$x##1354 == LHExercises.size f##aXU + 1}</span><span class='hs-varid'>b</span></a> <span class='hs-varop'>`cons`</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1370 : (LHExercises.SList a) | lq_tmp$x##1370 == acc##aXW}</span><span class='hs-varid'>acc</span></a>
<span class=hs-linenum>106: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1246 : a | $k_##1245[VV##1244:=lq_tmp$x##1246][lq_tmp$x##1243:=f##aXU]}</span><span class='hs-varid'>hd</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1248 : (LHExercises.SList a) | lq_tmp$x##1248 == f##aXU}</span><span class='hs-varid'>f</span></a> <span class='hs-varop'>`cons`</span> <a class=annot href="#"><span class=annottext>{v : (LHExercises.SList {lq_tmp$x##1317 : a | $k_##1316[VV##1315:=lq_tmp$x##1317][lq_tmp$x##1187:=lq_anf$##7205759403792801762##d27E][lq_tmp$x##1188:=lq_anf$##7205759403792801763##d27F][lq_tmp$x##1189:=lq_anf$##7205759403792801765##d27H]}) | LHExercises.size v == (LHExercises.size lq_anf$##7205759403792801762##d27E + LHExercises.size lq_anf$##7205759403792801763##d27F) + LHExercises.size lq_anf$##7205759403792801765##d27H}</span><span class='hs-varid'>rot</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1253 : (LHExercises.SList {lq_tmp$x##1258 : a | $k_##1257[VV##1256:=lq_tmp$x##1258][lq_tmp$x##1255:=f##aXU]}) | LHExercises.size lq_tmp$x##1253 == LHExercises.size f##aXU - 1}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>tl</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1260 : (LHExercises.SList a) | lq_tmp$x##1260 == f##aXU}</span><span class='hs-varid'>f</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1265 : (LHExercises.SList {lq_tmp$x##1270 : a | $k_##1269[VV##1268:=lq_tmp$x##1270][lq_tmp$x##1267:=b##aXV]}) | LHExercises.size lq_tmp$x##1265 == LHExercises.size b##aXV - 1}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>tl</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1272 : (LHExercises.SList a) | lq_tmp$x##1272 == b##aXV
                                          &amp;&amp; LHExercises.size lq_tmp$x##1272 == LHExercises.size f##aXU + 1}</span><span class='hs-varid'>b</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1289 : (LHExercises.SList {lq_tmp$x##1296 : a | $k_##1295[VV##1294:=lq_tmp$x##1296][lq_tmp$x##1292:=lq_anf$##7205759403792801764##d27G][lq_tmp$x##1293:=acc##aXW]}) | LHExercises.size lq_tmp$x##1289 == LHExercises.size acc##aXW + 1}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##1281 : a | $k_##1280[VV##1279:=lq_tmp$x##1281][lq_tmp$x##1278:=b##aXV]}</span><span class='hs-varid'>hd</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1283 : (LHExercises.SList a) | lq_tmp$x##1283 == b##aXV
                                          &amp;&amp; LHExercises.size lq_tmp$x##1283 == LHExercises.size f##aXU + 1}</span><span class='hs-varid'>b</span></a> <span class='hs-varop'>`cons`</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1299 : (LHExercises.SList a) | lq_tmp$x##1299 == acc##aXW}</span><span class='hs-varid'>acc</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>107: </span><span class='hs-comment'>-- end Victor</span>
<span class=hs-linenum>108: </span><span class='hs-comment'>-- ##########</span>
<span class=hs-linenum>109: </span>
<span class=hs-linenum>110: </span><span class='hs-comment'>-- Safe remove</span>
<span class=hs-linenum>111: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>removeMaybe</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>qi</span><span class='hs-conop'>:</span><span class='hs-conid'>QueueN</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>{qsize qi}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>mq</span><span class='hs-conop'>:</span> <span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>QueueN</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>{qsize qi - 1}</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>112: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1624:(LHExercises.Queue a) -&gt; (GHC.Maybe.Maybe (a, {VV##0 : (LHExercises.Queue a) | LHExercises.qsize VV##0 == LHExercises.qsize lq_tmp$x##1624 - 1}))</span><span class='hs-definition'>removeMaybe</span></a> <a class=annot href="#"><span class=annottext>(LHExercises.Queue a)</span><span class='hs-varid'>qi</span></a><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>Q</span> <span class='hs-varid'>f</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<span class=hs-linenum>113: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1656 : GHC.Types.Int | lq_tmp$x##1656 == LHExercises.size f##aXY
                                  &amp;&amp; lq_tmp$x##1656 &gt;= 0}</span><span class='hs-varid'>size</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1663 : (LHExercises.SList a) | lq_tmp$x##1663 == f##aXY}</span><span class='hs-varid'>f</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1668 : GHC.Types.Int | lq_tmp$x##1668 == (lq_anf$##7205759403792801781##d27X : int)}</span><span class='hs-num'>0</span></a> <span class='hs-varop'>&amp;&amp;</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1694 : GHC.Types.Int | lq_tmp$x##1694 == LHExercises.size b##aXZ
                                  &amp;&amp; lq_tmp$x##1694 &gt;= 0}</span><span class='hs-varid'>size</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1701 : (LHExercises.SList a) | lq_tmp$x##1701 == b##aXZ
                                          &amp;&amp; LHExercises.size lq_tmp$x##1701 &lt;= LHExercises.size f##aXY}</span><span class='hs-varid'>b</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1706 : GHC.Types.Int | lq_tmp$x##1706 == (lq_anf$##7205759403792801785##d281 : int)}</span><span class='hs-num'>0</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##2079 : (GHC.Maybe.Maybe a) | not (isJust lq_tmp$x##2079)} | VV == GHC.Maybe.Nothing}</span><span class='hs-conid'>Nothing</span></a>
<span class=hs-linenum>114: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1749 : GHC.Types.Int | lq_tmp$x##1749 == LHExercises.size f##aXY
                                  &amp;&amp; lq_tmp$x##1749 &gt;= 0}</span><span class='hs-varid'>size</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1756 : (LHExercises.SList a) | lq_tmp$x##1756 == f##aXY}</span><span class='hs-varid'>f</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1761 : GHC.Types.Int | lq_tmp$x##1761 == (lq_anf$##7205759403792801791##d287 : int)}</span><span class='hs-num'>0</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      lq_tmp$x##2044:a -&gt; {lq_tmp$x##2042 : (GHC.Maybe.Maybe a) | isJust lq_tmp$x##2042
                                                                  &amp;&amp; fromJust lq_tmp$x##2042 == lq_tmp$x##2044
                                                                  &amp;&amp; lqdc##$select##GHC.Maybe.Just##1 lq_tmp$x##2042 == lq_tmp$x##2044} | VV == GHC.Maybe.Just}</span><span class='hs-conid'>Just</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2015 : ({lq_tmp$x##2023 : a | $k_##2022[VV##2021:=lq_tmp$x##2023][lq_tmp$x##2018:=lq_anf$##7205759403792801802##d28i][lq_tmp$x##2019:=lq_anf$##7205759403792801807##d28n]}, {lq_tmp$x##2029 : (LHExercises.Queue {lq_tmp$x##2028 : a | $k_##2025[VV##2024:=lq_tmp$x##2028][VV##2026:=lq_tmp$x##2029][lq_tmp$x##2018:=lq_anf$##7205759403792801802##d28i][lq_tmp$x##2019:=lq_anf$##7205759403792801807##d28n]}) | $k_##2027[VV##2026:=lq_tmp$x##2029][lq_tmp$x##2018:=lq_anf$##7205759403792801802##d28i][lq_tmp$x##2019:=lq_anf$##7205759403792801807##d28n]})&lt;\lq_tmp$x##2020 VV -&gt; {lq_tmp$x##2029 : (LHExercises.Queue {lq_tmp$x##2028 : a | $k_##2031[VV##2030:=lq_tmp$x##2028][VV##2032:=lq_tmp$x##2029][lq_tmp$x##2018:=lq_anf$##7205759403792801802##d28i][lq_tmp$x##2019:=lq_anf$##7205759403792801807##d28n][lq_tmp$x##2034:=lq_tmp$x##2020]}) | $k_##2033[VV##2032:=lq_tmp$x##2029][lq_tmp$x##2018:=lq_anf$##7205759403792801802##d28i][lq_tmp$x##2019:=lq_anf$##7205759403792801807##d28n][lq_tmp$x##2034:=lq_tmp$x##2020]}&gt; | fst lq_tmp$x##2015 == lq_anf$##7205759403792801802##d28i
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     &amp;&amp; snd lq_tmp$x##2015 == lq_anf$##7205759403792801807##d28n
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     &amp;&amp; x_Tuple21 lq_tmp$x##2015 == lq_anf$##7205759403792801802##d28i
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     &amp;&amp; x_Tuple22 lq_tmp$x##2015 == lq_anf$##7205759403792801807##d28n}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##1945 : a | $k_##1944[VV##1943:=lq_tmp$x##1945][lq_tmp$x##1942:=lq_anf$##7205759403792801801##d28h]}</span><span class='hs-varid'>hd</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1921 : (LHExercises.SList {lq_tmp$x##1930 : a | $k_##1929[VV##1928:=lq_tmp$x##1930][lq_tmp$x##1925:=b##aXZ][lq_tmp$x##1926:=lq_anf$##7205759403792801799##d28f][lq_tmp$x##1927:=lq_anf$##7205759403792801800##d28g]}) | LHExercises.size lq_tmp$x##1921 == (LHExercises.size b##aXZ + LHExercises.size lq_anf$##7205759403792801799##d28f) + LHExercises.size lq_anf$##7205759403792801800##d28g}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>rot</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1932 : (LHExercises.SList a) | lq_tmp$x##1932 == b##aXZ
                                          &amp;&amp; LHExercises.size lq_tmp$x##1932 &lt;= LHExercises.size f##aXY}</span><span class='hs-varid'>b</span></a> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##1903 : (LHExercises.SList a) | LHExercises.size lq_tmp$x##1903 == 0} | VV == LHExercises.nil}</span><span class='hs-varid'>nil</span></a> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##1909 : (LHExercises.SList a) | LHExercises.size lq_tmp$x##1909 == 0} | VV == LHExercises.nil}</span><span class='hs-varid'>nil</span></a><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1996 : (LHExercises.Queue {lq_tmp$x##2003 : a | $k_##2002[VV##2001:=lq_tmp$x##2003][lq_tmp$x##1999:=lq_anf$##7205759403792801805##d28l][lq_tmp$x##2000:=lq_anf$##7205759403792801806##d28m]}) | LHExercises.back lq_tmp$x##1996 == lq_anf$##7205759403792801806##d28m
                                                                                                                                                                                                           &amp;&amp; LHExercises.front lq_tmp$x##1996 == lq_anf$##7205759403792801805##d28l
                                                                                                                                                                                                           &amp;&amp; LHExercises.qsize lq_tmp$x##1996 == LHExercises.size lq_anf$##7205759403792801805##d28l + LHExercises.size lq_anf$##7205759403792801806##d28m}</span><span class='hs-conid'>Q</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1968 : (LHExercises.SList {lq_tmp$x##1977 : a | $k_##1976[VV##1975:=lq_tmp$x##1977][lq_tmp$x##1972:=b##aXZ][lq_tmp$x##1973:=lq_anf$##7205759403792801803##d28j][lq_tmp$x##1974:=lq_anf$##7205759403792801804##d28k]}) | LHExercises.size lq_tmp$x##1968 == (LHExercises.size b##aXZ + LHExercises.size lq_anf$##7205759403792801803##d28j) + LHExercises.size lq_anf$##7205759403792801804##d28k}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>rot</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1979 : (LHExercises.SList a) | lq_tmp$x##1979 == b##aXZ
                                          &amp;&amp; LHExercises.size lq_tmp$x##1979 &lt;= LHExercises.size f##aXY}</span><span class='hs-varid'>b</span></a> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##1950 : (LHExercises.SList a) | LHExercises.size lq_tmp$x##1950 == 0} | VV == LHExercises.nil}</span><span class='hs-varid'>nil</span></a> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##1956 : (LHExercises.SList a) | LHExercises.size lq_tmp$x##1956 == 0} | VV == LHExercises.nil}</span><span class='hs-varid'>nil</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##1986 : (LHExercises.SList a) | LHExercises.size lq_tmp$x##1986 == 0} | VV == LHExercises.nil}</span><span class='hs-varid'>nil</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>115: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      lq_tmp$x##1868:a -&gt; {lq_tmp$x##1866 : (GHC.Maybe.Maybe a) | isJust lq_tmp$x##1866
                                                                  &amp;&amp; fromJust lq_tmp$x##1866 == lq_tmp$x##1868
                                                                  &amp;&amp; lqdc##$select##GHC.Maybe.Just##1 lq_tmp$x##1866 == lq_tmp$x##1868} | VV == GHC.Maybe.Just}</span><span class='hs-conid'>Just</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1839 : ({lq_tmp$x##1847 : a | $k_##1846[VV##1845:=lq_tmp$x##1847][lq_tmp$x##1842:=lq_anf$##7205759403792801795##d28b][lq_tmp$x##1843:=lq_anf$##7205759403792801797##d28d]}, {lq_tmp$x##1853 : (LHExercises.Queue {lq_tmp$x##1852 : a | $k_##1849[VV##1848:=lq_tmp$x##1852][VV##1850:=lq_tmp$x##1853][lq_tmp$x##1842:=lq_anf$##7205759403792801795##d28b][lq_tmp$x##1843:=lq_anf$##7205759403792801797##d28d]}) | $k_##1851[VV##1850:=lq_tmp$x##1853][lq_tmp$x##1842:=lq_anf$##7205759403792801795##d28b][lq_tmp$x##1843:=lq_anf$##7205759403792801797##d28d]})&lt;\lq_tmp$x##1844 VV -&gt; {lq_tmp$x##1853 : (LHExercises.Queue {lq_tmp$x##1852 : a | $k_##1855[VV##1854:=lq_tmp$x##1852][VV##1856:=lq_tmp$x##1853][lq_tmp$x##1842:=lq_anf$##7205759403792801795##d28b][lq_tmp$x##1843:=lq_anf$##7205759403792801797##d28d][lq_tmp$x##1858:=lq_tmp$x##1844]}) | $k_##1857[VV##1856:=lq_tmp$x##1853][lq_tmp$x##1842:=lq_anf$##7205759403792801795##d28b][lq_tmp$x##1843:=lq_anf$##7205759403792801797##d28d][lq_tmp$x##1858:=lq_tmp$x##1844]}&gt; | fst lq_tmp$x##1839 == lq_anf$##7205759403792801795##d28b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     &amp;&amp; snd lq_tmp$x##1839 == lq_anf$##7205759403792801797##d28d
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     &amp;&amp; x_Tuple21 lq_tmp$x##1839 == lq_anf$##7205759403792801795##d28b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     &amp;&amp; x_Tuple22 lq_tmp$x##1839 == lq_anf$##7205759403792801797##d28d}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##1799 : a | $k_##1798[VV##1797:=lq_tmp$x##1799][lq_tmp$x##1796:=f##aXY]}</span><span class='hs-varid'>hd</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1801 : (LHExercises.SList a) | lq_tmp$x##1801 == f##aXY}</span><span class='hs-varid'>f</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1820 : (LHExercises.Queue {lq_tmp$x##1827 : a | $k_##1826[VV##1825:=lq_tmp$x##1827][lq_tmp$x##1823:=lq_anf$##7205759403792801796##d28c][lq_tmp$x##1824:=b##aXZ]}) | LHExercises.qsize lq_tmp$x##1820 == LHExercises.size lq_anf$##7205759403792801796##d28c + LHExercises.size b##aXZ}</span><span class='hs-varid'>makeq</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1806 : (LHExercises.SList {lq_tmp$x##1811 : a | $k_##1810[VV##1809:=lq_tmp$x##1811][lq_tmp$x##1808:=f##aXY]}) | LHExercises.size lq_tmp$x##1806 == LHExercises.size f##aXY - 1}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>tl</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1813 : (LHExercises.SList a) | lq_tmp$x##1813 == f##aXY}</span><span class='hs-varid'>f</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1831 : (LHExercises.SList a) | lq_tmp$x##1831 == b##aXZ
                                          &amp;&amp; LHExercises.size lq_tmp$x##1831 &lt;= LHExercises.size f##aXY}</span><span class='hs-varid'>b</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>116: </span>
<span class=hs-linenum>117: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>remove</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{qi:</span><span class='hs-conid'>QueueN</span> <span class='hs-varid'>a</span> <span class='hs-layout'>{</span><span class='hs-varid'>qsize</span> <span class='hs-varid'>qi</span><span class='hs-layout'>}</span><span class='hs-keyword'> </span><span class='hs-keyglyph'>|</span> <span class='hs-varid'>qsize</span> <span class='hs-varid'>qi</span> <span class='hs-varop'>&gt;</span> <span class='hs-num'>0</span><span class='hs-layout'>}</span><span class='hs-keyword'> -&gt; (a, QueueN a </span><span class='hs-layout'>{</span><span class='hs-varid'>qsize</span> <span class='hs-varid'>qi</span> <span class='hs-comment'>-</span> <span class='hs-num'>1</span><span class='hs-layout'>}</span><span class='hs-keyword'>) </span><span class='hs-keyword'>@-}</span>
<span class=hs-linenum>118: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1503:{VV##0 : (LHExercises.Queue a) | LHExercises.qsize VV##0 == LHExercises.qsize VV##0
                                                &amp;&amp; LHExercises.qsize VV##0 &gt; 0} -&gt; (a, {VV##0 : (LHExercises.Queue a) | LHExercises.qsize VV##0 == LHExercises.qsize lq_tmp$x##1503 - 1})</span><span class='hs-definition'>remove</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Q</span> <span class='hs-varid'>f</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b &lt;p2 :: a b -&gt; Bool&gt;.
      lq_tmp$x##1583:a -&gt; lq_tmp$x##1584:{lq_tmp$x##1575 : b&lt;p2 lq_tmp$x##1583&gt; | true} -&gt; {lq_tmp$x##1580 : (a, b)&lt;\lq_tmp$x##1585 VV -&gt; {lq_tmp$x##1579 : b&lt;p2 lq_tmp$x##1585&gt; | true}&gt; | fst lq_tmp$x##1580 == lq_tmp$x##1583
                                                                                                                                                                                            &amp;&amp; snd lq_tmp$x##1580 == lq_tmp$x##1584
                                                                                                                                                                                            &amp;&amp; x_Tuple21 lq_tmp$x##1580 == lq_tmp$x##1583
                                                                                                                                                                                            &amp;&amp; x_Tuple22 lq_tmp$x##1580 == lq_tmp$x##1584} | VV == GHC.Tuple.(,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##1540 : a | $k_##1539[VV##1538:=lq_tmp$x##1540][lq_tmp$x##1537:=f##aY0]}</span><span class='hs-varid'>hd</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1542 : (LHExercises.SList a) | lq_tmp$x##1542 == f##aY0}</span><span class='hs-varid'>f</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1561 : (LHExercises.Queue {lq_tmp$x##1568 : a | $k_##1567[VV##1566:=lq_tmp$x##1568][lq_tmp$x##1564:=lq_anf$##7205759403792801777##d27T][lq_tmp$x##1565:=b##aY1]}) | LHExercises.qsize lq_tmp$x##1561 == LHExercises.size lq_anf$##7205759403792801777##d27T + LHExercises.size b##aY1}</span><span class='hs-varid'>makeq</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1547 : (LHExercises.SList {lq_tmp$x##1552 : a | $k_##1551[VV##1550:=lq_tmp$x##1552][lq_tmp$x##1549:=f##aY0]}) | LHExercises.size lq_tmp$x##1547 == LHExercises.size f##aY0 - 1}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>tl</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1554 : (LHExercises.SList a) | lq_tmp$x##1554 == f##aY0}</span><span class='hs-varid'>f</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1572 : (LHExercises.SList a) | lq_tmp$x##1572 == b##aY1
                                          &amp;&amp; LHExercises.size lq_tmp$x##1572 &lt;= LHExercises.size f##aY0}</span><span class='hs-varid'>b</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>119: </span>
<span class=hs-linenum>120: </span><span class='hs-comment'>-- {-@ okRemove :: Maybe (_, QueueN _ 1) @-}</span>
<span class=hs-linenum>121: </span><a class=annot href="#"><span class=annottext>(GHC.Num.Integer.Integer, (LHExercises.Queue GHC.Num.Integer.Integer))</span><span class='hs-definition'>okRemove</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>remove</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1622 : (LHExercises.Queue GHC.Num.Integer.Integer) | lq_tmp$x##1622 == LHExercises.example2Q
                                                                &amp;&amp; LHExercises.qsize lq_tmp$x##1622 == 2}</span><span class='hs-varid'>example2Q</span></a> <span class='hs-comment'>-- accept</span>
<span class=hs-linenum>122: </span>
<span class=hs-linenum>123: </span><span class='hs-comment'>-- badRemove = remove example0Q -- reject</span>
<span class=hs-linenum>124: </span>
<span class=hs-linenum>125: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>emp</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>QueueN</span> <span class='hs-keyword'>_</span> <span class='hs-num'>0</span> <span class='hs-keyword'>@-}</span> 
<span class=hs-linenum>126: </span><a class=annot href="#"><span class=annottext>forall a .
{VV##0 : (LHExercises.Queue a) | LHExercises.qsize VV##0 == 0}</span><span class='hs-definition'>emp</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Q</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##665 : (LHExercises.SList a) | LHExercises.size lq_tmp$x##665 == 0} | VV == LHExercises.nil}</span><span class='hs-varid'>nil</span></a> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##671 : (LHExercises.SList a) | LHExercises.size lq_tmp$x##671 == 0} | VV == LHExercises.nil}</span><span class='hs-varid'>nil</span></a>
<span class=hs-linenum>127: </span>
<span class=hs-linenum>128: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>example2Q</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>QueueN</span> <span class='hs-keyword'>_</span> <span class='hs-num'>2</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>129: </span><a class=annot href="#"><span class=annottext>{VV##0 : (LHExercises.Queue GHC.Num.Integer.Integer) | LHExercises.qsize VV##0 == 2}</span><span class='hs-definition'>example2Q</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Q</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##878 : (LHExercises.SList {lq_tmp$x##885 : GHC.Num.Integer.Integer | $k_##884[VV##883:=lq_tmp$x##885][lq_tmp$x##881:=lq_anf$##7205759403792801737##d27f][lq_tmp$x##882:=lq_anf$##7205759403792801740##d27i]}) | LHExercises.size lq_tmp$x##878 == LHExercises.size lq_anf$##7205759403792801740##d27i + 1}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##848 : GHC.Num.Integer.Integer | lq_tmp$x##848 == 1}</span><span class='hs-num'>1</span></a> <span class='hs-varop'>`cons`</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##862 : (LHExercises.SList {lq_tmp$x##869 : GHC.Num.Integer.Integer | $k_##868[VV##867:=lq_tmp$x##869][lq_tmp$x##865:=lq_anf$##7205759403792801738##d27g][lq_tmp$x##866:=lq_anf$##7205759403792801739##d27h]}) | LHExercises.size lq_tmp$x##862 == LHExercises.size lq_anf$##7205759403792801739##d27h + 1}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##850 : GHC.Num.Integer.Integer | lq_tmp$x##850 == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>`cons`</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##853 : (LHExercises.SList a) | LHExercises.size lq_tmp$x##853 == 0} | VV == LHExercises.nil}</span><span class='hs-varid'>nil</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##891 : (LHExercises.SList a) | LHExercises.size lq_tmp$x##891 == 0} | VV == LHExercises.nil}</span><span class='hs-varid'>nil</span></a>
<span class=hs-linenum>130: </span>
<span class=hs-linenum>131: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>example0Q</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>QueueN</span> <span class='hs-keyword'>_</span> <span class='hs-num'>0</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>132: </span><a class=annot href="#"><span class=annottext>forall a .
{VV##0 : (LHExercises.Queue a) | LHExercises.qsize VV##0 == 0}</span><span class='hs-definition'>example0Q</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Q</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##702 : (LHExercises.SList a) | LHExercises.size lq_tmp$x##702 == 0} | VV == LHExercises.nil}</span><span class='hs-varid'>nil</span></a> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##708 : (LHExercises.SList a) | LHExercises.size lq_tmp$x##708 == 0} | VV == LHExercises.nil}</span><span class='hs-varid'>nil</span></a>
<span class=hs-linenum>133: </span>
<span class=hs-linenum>134: </span><span class='hs-comment'>-- Exercise 9.4</span>
<span class=hs-linenum>135: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>136: </span>
<span class=hs-linenum>137: </span><span class='hs-comment'>-- TODO</span>
<span class=hs-linenum>138: </span><span class='hs-comment'>-- | Insert an element into a queue</span>
<span class=hs-linenum>139: </span><span class='hs-comment'>-- {-@ insert :: x:a -&gt; qi:Queue a -&gt; QueueN a {qsize qi + 1} @-}</span>
<span class=hs-linenum>140: </span><span class='hs-comment'>-- insert e (Q f b) = makeq f (e `cons` b)</span>
<span class=hs-linenum>141: </span>
<span class=hs-linenum>142: </span><span class='hs-comment'>-- {-@ replicate :: n:Nat -&gt; a -&gt; QueueN a n @-}</span>
<span class=hs-linenum>143: </span><span class='hs-comment'>-- replicate 0 _ = emp</span>
<span class=hs-linenum>144: </span><span class='hs-comment'>-- replicate n x = insert x (replicate (n-1) x)</span>
<span class=hs-linenum>145: </span>
<span class=hs-linenum>146: </span><span class='hs-comment'>-- {-@ okReplicate :: QueueN _ 3 @-}</span>
<span class=hs-linenum>147: </span><span class='hs-comment'>-- okReplicate = replicate 3 "Yeah!"</span>
<span class=hs-linenum>148: </span><span class='hs-comment'>-- -- accept</span>
<span class=hs-linenum>149: </span>
<span class=hs-linenum>150: </span><span class='hs-comment'>-- {-@ badReplicate :: QueueN _ 3 @-}</span>
<span class=hs-linenum>151: </span><span class='hs-comment'>-- badReplicate = replicate 1 "No!"</span>
<span class=hs-linenum>152: </span><span class='hs-comment'>-- -- reject</span></pre>
</body>
</html>