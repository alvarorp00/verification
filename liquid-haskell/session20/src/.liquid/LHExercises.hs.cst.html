<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>/home/alvarorp00/Documents/uam/master/verification/liquid-haskell/session20/src/LHExercises.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum>  1: </span><a class=annot href="#"><span class=annottext>{VV##1773 : GHC.Types.Module | $k_##1774}</span>
</a><span class=hs-linenum>  2: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>LHExercises</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>  3: </span>
<span class=hs-linenum>  4: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Maybe</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>Maybe</span>
<span class=hs-linenum>  5: </span>
<span class=hs-linenum>  6: </span><span class='hs-comment'>-- import Prelude</span>
<span class=hs-linenum>  7: </span>
<span class=hs-linenum>  8: </span><span class='hs-comment'>-- Exercise 1:  Define a Skew heap in Liquid Haskell and implement</span>
<span class=hs-linenum>  9: </span><span class='hs-comment'>-- and verify its operation join, joining two skew heaps </span>
<span class=hs-linenum> 10: </span><span class='hs-comment'>-- into one (see the dafny file to inspire you)</span>
<span class=hs-linenum> 11: </span>
<span class=hs-linenum> 12: </span>
<span class=hs-linenum> 13: </span><span class='hs-comment'>-- Exercise 2: Specify and define in Liquid Haskell a quicksort algorithm ensuring</span>
<span class=hs-linenum> 14: </span><span class='hs-comment'>-- an ordered output list and having the same set of elements as the input list</span>
<span class=hs-linenum> 15: </span>
<span class=hs-linenum> 16: </span>
<span class=hs-linenum> 17: </span><span class='hs-comment'>-- Exercise 3: Complete the exercise 7.10 of the LH book about the function</span>
<span class=hs-linenum> 18: </span><span class='hs-comment'>-- matFromList      :: [[a]] -&gt; Maybe (Matrix a)</span>
<span class=hs-linenum> 19: </span>
<span class=hs-linenum> 20: </span><span class='hs-comment'>-- Exercise 4: Complete the exercise 7.12 of the LH book about the function</span>
<span class=hs-linenum> 21: </span><span class='hs-comment'>-- {-@ transpose :: m:Matrix a -&gt; MatrixN a (mCol m) (mRow m) @-}</span>
<span class=hs-linenum> 22: </span>
<span class=hs-linenum> 23: </span>
<span class=hs-linenum> 24: </span><span class='hs-comment'>-- Exercise 5: Read Chapter 9 of the LH book about lazy queues and do the exercises &lt;-- MINE  # ASSIGNMENT</span>
<span class=hs-linenum> 25: </span><span class='hs-comment'>-- 9.3 and 9.4</span>
<span class=hs-linenum> 26: </span>
<span class=hs-linenum> 27: </span>
<span class=hs-linenum> 28: </span><span class='hs-comment'>-- Exercise 6: Read Chapter 9 of the LH book about lazy queues and do the exercises</span>
<span class=hs-linenum> 29: </span><span class='hs-comment'>-- 9.5 and 9.6</span>
<span class=hs-linenum> 30: </span>
<span class=hs-linenum> 31: </span>
<span class=hs-linenum> 32: </span><span class='hs-comment'>-- For exercises 5 and 6, you can use the following definitions:</span>
<span class=hs-linenum> 33: </span>
<span class=hs-linenum> 34: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SL</span> <span class='hs-layout'>{</span> <span class='hs-varid'>size</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span><span class='hs-layout'>,</span> <span class='hs-varid'>elems</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-layout'>}</span>
<span class=hs-linenum> 35: </span>
<span class=hs-linenum> 36: </span><span class='hs-comment'>-- {-@ size :: q:SList a -&gt; {v:Nat | v = size q} @-}</span>
<span class=hs-linenum> 37: </span>
<span class=hs-linenum> 38: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>realSize</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 39: </span><span class='hs-definition'>realSize</span>      <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum> 40: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##480:[a] -&gt; {VV : GHC.Types.Int | VV == LHExercises.realSize lq_tmp$x##480}</span><span class='hs-definition'>realSize</span></a> <span class='hs-conid'>[]</span>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##506 : GHC.Prim.Int# | lq_tmp$x##506 == 0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum> 41: </span><span class='hs-definition'>realSize</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##552 : GHC.Types.Int | lq_tmp$x##552 == (lq_anf$##7205759403793234485##d1QH3 : int)}</span><span class='hs-num'>1</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##561 : GHC.Types.Int | lq_tmp$x##561 == LHExercises.realSize xs##a1QAf}</span><span class='hs-varid'>realSize</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##572 : [a] | lq_tmp$x##572 == xs##a1QAf
                       &amp;&amp; len lq_tmp$x##572 &gt;= 0}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum> 42: </span><span class='hs-comment'>-- \end{code}</span>
<span class=hs-linenum> 43: </span>
<span class=hs-linenum> 44: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>data</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SL</span> <span class='hs-layout'>{</span>
<span class=hs-linenum> 45: </span>       <span class='hs-varid'>size</span>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Nat</span> 
<span class=hs-linenum> 46: </span>     <span class='hs-layout'>,</span> <span class='hs-varid'>elems</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>realSize</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>size</span><span class='hs-layout'>}</span>
<span class=hs-linenum> 47: </span>     <span class='hs-layout'>}</span>
<span class=hs-linenum> 48: </span><span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 49: </span>
<span class=hs-linenum> 50: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>SListN</span> <span class='hs-varid'>a</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>size</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>N</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 51: </span>
<span class=hs-linenum> 52: </span>
<span class=hs-linenum> 53: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>NEList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>size</span> <span class='hs-varid'>v</span> <span class='hs-varop'>&gt;</span> <span class='hs-num'>0</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 54: </span>
<span class=hs-linenum> 55: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>SListLE</span> <span class='hs-varid'>a</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>size</span> <span class='hs-varid'>v</span> <span class='hs-varop'>&lt;=</span> <span class='hs-conid'>N</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 56: </span>
<span class=hs-linenum> 57: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>nil</span>          <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SListN</span> <span class='hs-varid'>a</span> <span class='hs-num'>0</span>  <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 58: </span><span class='hs-definition'>nil</span>              <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 59: </span><a class=annot href="#"><span class=annottext>forall a .
{VV##0 : (LHExercises.SList a) | LHExercises.size VV##0 == 0}</span><span class='hs-definition'>nil</span></a>              <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SL</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##598 : GHC.Types.Int | lq_tmp$x##598 == (lq_anf$##7205759403793234488##d1QH6 : int)}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {lq_tmp$x##606 : [a]&lt;\lq_tmp$x##607 VV -&gt; {lq_tmp$x##605 : a&lt;p lq_tmp$x##607&gt; | true}&gt; | LHExercises.realSize lq_tmp$x##606 == 0
                                                                                               &amp;&amp; len lq_tmp$x##606 == 0} | VV == GHC.Types.[]}</span><span class='hs-conid'>[]</span></a>
<span class=hs-linenum> 60: </span>
<span class=hs-linenum> 61: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>cons</span>         <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span><span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SListN</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>{size xs + 1}</span>   <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 62: </span><span class='hs-definition'>cons</span>             <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 63: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##716:a -&gt; lq_tmp$x##717:(LHExercises.SList a) -&gt; {VV##0 : (LHExercises.SList a) | LHExercises.size VV##0 == LHExercises.size lq_tmp$x##717 + 1}</span><span class='hs-definition'>cons</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>SL</span> <span class='hs-varid'>n</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      lq_tmp$x##816:{lq_tmp$x##806 : GHC.Types.Int | lq_tmp$x##806 &gt;= 0} -&gt; lq_tmp$x##817:{lq_tmp$x##810 : [a] | LHExercises.realSize lq_tmp$x##810 == lq_tmp$x##816} -&gt; {lq_tmp$x##812 : (LHExercises.SList a) | LHExercises.elems lq_tmp$x##812 == lq_tmp$x##817
                                                                                                                                                                                                                  &amp;&amp; LHExercises.size lq_tmp$x##812 == lq_tmp$x##816} | VV == LHExercises.SL}</span><span class='hs-conid'>SL</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##770 : GHC.Types.Int | lq_tmp$x##770 == n##a1QAh + lq_anf$##7205759403793234497##d1QHf}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##773 : GHC.Types.Int | lq_tmp$x##773 == n##a1QAh
                                 &amp;&amp; lq_tmp$x##773 &gt;= 0}</span><span class='hs-varid'>n</span></a><span class='hs-varop'>+</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##754 : GHC.Types.Int | lq_tmp$x##754 == (lq_anf$##7205759403793234496##d1QHe : int)}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##784 : [{lq_tmp$x##794 : a | $k_##793[VV##792:=lq_tmp$x##794][lq_tmp$x##788:=x##a1QAg][lq_tmp$x##789:=xs##a1QAi]}]&lt;\lq_tmp$x##791 VV -&gt; {lq_tmp$x##794 : a | $k_##796[VV##795:=lq_tmp$x##794][lq_tmp$x##788:=x##a1QAg][lq_tmp$x##789:=xs##a1QAi][lq_tmp$x##797:=lq_tmp$x##791]}&gt; | LHExercises.realSize lq_tmp$x##784 == 1 + LHExercises.realSize xs##a1QAi
                                                                                                                                                                                                                                                                                             &amp;&amp; head lq_tmp$x##784 == x##a1QAg
                                                                                                                                                                                                                                                                                             &amp;&amp; len lq_tmp$x##784 == 1 + len xs##a1QAi
                                                                                                                                                                                                                                                                                             &amp;&amp; tail lq_tmp$x##784 == xs##a1QAi}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##799 : a | lq_tmp$x##799 == x##a1QAg}</span><span class='hs-varid'>x</span></a><span class='hs-conop'>:</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##803 : [a] | lq_tmp$x##803 == xs##a1QAi
                       &amp;&amp; LHExercises.realSize lq_tmp$x##803 == n##a1QAh
                       &amp;&amp; len lq_tmp$x##803 &gt;= 0}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 64: </span>
<span class=hs-linenum> 65: </span>
<span class=hs-linenum> 66: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>tl</span>           <span class='hs-keyglyph'>::</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span><span class='hs-conid'>NEList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SListN</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>{size xs - 1}</span>  <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 67: </span><span class='hs-definition'>tl</span>              <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 68: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##896:{VV##0 : (LHExercises.SList a) | LHExercises.size VV##0 &gt; 0} -&gt; {VV##0 : (LHExercises.SList a) | LHExercises.size VV##0 == LHExercises.size lq_tmp$x##896 - 1}</span><span class='hs-definition'>tl</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>SL</span> <span class='hs-varid'>n</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      lq_tmp$x##1041:{lq_tmp$x##1031 : GHC.Types.Int | lq_tmp$x##1031 &gt;= 0} -&gt; lq_tmp$x##1042:{lq_tmp$x##1035 : [a] | LHExercises.realSize lq_tmp$x##1035 == lq_tmp$x##1041} -&gt; {lq_tmp$x##1037 : (LHExercises.SList a) | LHExercises.elems lq_tmp$x##1037 == lq_tmp$x##1042
                                                                                                                                                                                                                          &amp;&amp; LHExercises.size lq_tmp$x##1037 == lq_tmp$x##1041} | VV == LHExercises.SL}</span><span class='hs-conid'>SL</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1025 : GHC.Types.Int | lq_tmp$x##1025 == n##a1QAj - lq_anf$##7205759403793234512##d1QHu}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##1028 : GHC.Types.Int | lq_tmp$x##1028 == n##a1QAj
                                  &amp;&amp; lq_tmp$x##1028 &gt;= 0}</span><span class='hs-varid'>n</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##1009 : GHC.Types.Int | lq_tmp$x##1009 == (lq_anf$##7205759403793234511##d1QHt : int)}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1051 : [a] | lq_tmp$x##1051 == xs##a1QAk
                        &amp;&amp; len lq_tmp$x##1051 &gt;= 0}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum> 69: </span>
<span class=hs-linenum> 70: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>hd</span>           <span class='hs-keyglyph'>::</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span><span class='hs-conid'>NEList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 71: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1054:{VV##0 : (LHExercises.SList a) | LHExercises.size VV##0 &gt; 0} -&gt; a</span><span class='hs-definition'>hd</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>SL</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1164 : a | lq_tmp$x##1164 == x##a1QAl}</span><span class='hs-varid'>x</span></a> 
<span class=hs-linenum> 72: </span>
<span class=hs-linenum> 73: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Queue</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Q</span>  <span class='hs-layout'>{</span> <span class='hs-varid'>front</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 74: </span>                  <span class='hs-layout'>,</span> <span class='hs-varid'>back</span>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 75: </span>                  <span class='hs-layout'>}</span>
<span class=hs-linenum> 76: </span>
<span class=hs-linenum> 77: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>data</span> <span class='hs-conid'>Queue</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Q</span> <span class='hs-layout'>{</span>
<span class=hs-linenum> 78: </span>      <span class='hs-varid'>front</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> 
<span class=hs-linenum> 79: </span>   <span class='hs-layout'>,</span>  <span class='hs-varid'>back</span>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SListLE</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-varid'>size</span> <span class='hs-varid'>front</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 80: </span>   <span class='hs-layout'>}</span>
<span class=hs-linenum> 81: </span><span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 82: </span>
<span class=hs-linenum> 83: </span><span class='hs-comment'>-- Exercise 9.3</span>
<span class=hs-linenum> 84: </span>
<span class=hs-linenum> 85: </span><span class='hs-comment'>-- Write a measure to describe the queue size</span>
<span class=hs-linenum> 86: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>qsize</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 87: </span><span class='hs-definition'>qsize</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Queue</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum> 88: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1705:(LHExercises.Queue a) -&gt; {VV : GHC.Types.Int | VV == LHExercises.qsize lq_tmp$x##1705}</span><span class='hs-definition'>qsize</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Q</span> <span class='hs-varid'>f</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1736 : GHC.Types.Int | lq_tmp$x##1736 == LHExercises.size f##a1QAm
                                  &amp;&amp; lq_tmp$x##1736 &gt;= 0}</span><span class='hs-varid'>size</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1743 : (LHExercises.SList a) | lq_tmp$x##1743 == f##a1QAm}</span><span class='hs-varid'>f</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1747 : GHC.Types.Int | lq_tmp$x##1747 == LHExercises.size b##a1QAn
                                  &amp;&amp; lq_tmp$x##1747 &gt;= 0}</span><span class='hs-varid'>size</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1754 : (LHExercises.SList a) | lq_tmp$x##1754 == b##a1QAn
                                          &amp;&amp; LHExercises.size lq_tmp$x##1754 &lt;= LHExercises.size f##a1QAm}</span><span class='hs-varid'>b</span></a>
<span class=hs-linenum> 89: </span>
<span class=hs-linenum> 90: </span><span class='hs-comment'>-- Use it to complete the definition of QueueN</span>
<span class=hs-linenum> 91: </span>
<span class=hs-linenum> 92: </span><span class='hs-comment'>-- | Queues of size `N`</span>
<span class=hs-linenum> 93: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>QueueN</span> <span class='hs-varid'>a</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>Queue</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>qsize</span> <span class='hs-varid'>v</span> <span class='hs-varop'>==</span> <span class='hs-conid'>N</span> <span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 94: </span>
<span class=hs-linenum> 95: </span><span class='hs-comment'>-- ############</span>
<span class=hs-linenum> 96: </span><span class='hs-comment'>-- start Victor</span>
<span class=hs-linenum> 97: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>makeq</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>f</span><span class='hs-conop'>:</span><span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-conop'>:</span><span class='hs-conid'>SListLE</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>{size f + 1}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>QueueN</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>{size f + size b}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 98: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1356:(LHExercises.SList a) -&gt; lq_tmp$x##1357:{VV##0 : (LHExercises.SList a) | LHExercises.size VV##0 &lt;= LHExercises.size lq_tmp$x##1356 + 1} -&gt; {VV##0 : (LHExercises.Queue a) | LHExercises.qsize VV##0 == LHExercises.size lq_tmp$x##1356 + LHExercises.size lq_tmp$x##1357}</span><span class='hs-definition'>makeq</span></a> <a class=annot href="#"><span class=annottext>(LHExercises.SList a)</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{VV##0 : (LHExercises.SList a) | LHExercises.size VV##0 &lt;= LHExercises.size f##a1QAo + 1}</span><span class='hs-varid'>b</span></a>
<span class=hs-linenum> 99: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1362 : GHC.Types.Int | lq_tmp$x##1362 == LHExercises.size b##a1QAp
                                  &amp;&amp; lq_tmp$x##1362 &gt;= 0}</span><span class='hs-varid'>size</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1369 : (LHExercises.SList a) | lq_tmp$x##1369 == b##a1QAp
                                          &amp;&amp; LHExercises.size lq_tmp$x##1369 &lt;= LHExercises.size f##a1QAo + 1}</span><span class='hs-varid'>b</span></a> <span class='hs-varop'>&lt;=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1373 : GHC.Types.Int | lq_tmp$x##1373 == LHExercises.size f##a1QAo
                                  &amp;&amp; lq_tmp$x##1373 &gt;= 0}</span><span class='hs-varid'>size</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1380 : (LHExercises.SList a) | lq_tmp$x##1380 == f##a1QAo}</span><span class='hs-varid'>f</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      lq_tmp$x##1474:(LHExercises.SList a) -&gt; lq_tmp$x##1475:{lq_tmp$x##1469 : (LHExercises.SList a) | LHExercises.size lq_tmp$x##1469 &lt;= LHExercises.size lq_tmp$x##1474} -&gt; {lq_tmp$x##1471 : (LHExercises.Queue a) | LHExercises.back lq_tmp$x##1471 == lq_tmp$x##1475
                                                                                                                                                                                                                        &amp;&amp; LHExercises.front lq_tmp$x##1471 == lq_tmp$x##1474
                                                                                                                                                                                                                        &amp;&amp; LHExercises.qsize lq_tmp$x##1471 == LHExercises.size lq_tmp$x##1474 + LHExercises.size lq_tmp$x##1475} | VV == LHExercises.Q}</span><span class='hs-conid'>Q</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1480 : (LHExercises.SList a) | lq_tmp$x##1480 == f##a1QAo}</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1482 : (LHExercises.SList a) | lq_tmp$x##1482 == b##a1QAp
                                          &amp;&amp; LHExercises.size lq_tmp$x##1482 &lt;= LHExercises.size f##a1QAo + 1}</span><span class='hs-varid'>b</span></a>
<span class=hs-linenum>100: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1439 : (LHExercises.SList {lq_tmp$x##1442 : a | $k_##1441[VV##1440:=lq_tmp$x##1442]}) | LHExercises.size lq_tmp$x##1439 == 0}</span><span class='hs-conid'>Q</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1421 : (LHExercises.SList {lq_tmp$x##1430 : a | $k_##1429[VV##1428:=lq_tmp$x##1430][lq_tmp$x##1425:=f##a1QAo][lq_tmp$x##1426:=b##a1QAp][lq_tmp$x##1427:=lq_anf$##7205759403793234535##d1QHR]}) | LHExercises.size lq_tmp$x##1421 == (LHExercises.size f##a1QAo + LHExercises.size b##a1QAp) + LHExercises.size lq_anf$##7205759403793234535##d1QHR}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>rot</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1432 : (LHExercises.SList a) | lq_tmp$x##1432 == f##a1QAo}</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1434 : (LHExercises.SList a) | lq_tmp$x##1434 == b##a1QAp
                                          &amp;&amp; LHExercises.size lq_tmp$x##1434 &lt;= LHExercises.size f##a1QAo + 1}</span><span class='hs-varid'>b</span></a> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##1409 : (LHExercises.SList a) | LHExercises.size lq_tmp$x##1409 == 0} | VV == LHExercises.nil}</span><span class='hs-varid'>nil</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##1439 : (LHExercises.SList a) | LHExercises.size lq_tmp$x##1439 == 0} | VV == LHExercises.nil}</span><span class='hs-varid'>nil</span></a>
<span class=hs-linenum>101: </span>
<span class=hs-linenum>102: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>rot</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>f</span><span class='hs-conop'>:</span><span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-conop'>:</span><span class='hs-conid'>SListN</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>{size f + 1}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>acc</span><span class='hs-conop'>:</span><span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{v:</span><span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| size v = size f + size b + size acc }</span> <span class='hs-varop'>/</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>size</span> <span class='hs-varid'>f</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>103: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1169:(LHExercises.SList a) -&gt; lq_tmp$x##1170:{VV##0 : (LHExercises.SList a) | LHExercises.size VV##0 == LHExercises.size lq_tmp$x##1169 + 1} -&gt; lq_tmp$x##1171:(LHExercises.SList a) -&gt; {v : (LHExercises.SList a) | LHExercises.size v == (LHExercises.size lq_tmp$x##1169 + LHExercises.size lq_tmp$x##1170) + LHExercises.size lq_tmp$x##1171}</span><span class='hs-definition'>rot</span></a> <a class=annot href="#"><span class=annottext>(LHExercises.SList a)</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{VV##0 : (LHExercises.SList a) | LHExercises.size VV##0 == LHExercises.size f##a1QAq + 1}</span><span class='hs-varid'>b</span></a> <a class=annot href="#"><span class=annottext>(LHExercises.SList a)</span><span class='hs-varid'>acc</span></a>
<span class=hs-linenum>104: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1178 : GHC.Types.Int | lq_tmp$x##1178 == LHExercises.size f##a1QAq
                                  &amp;&amp; lq_tmp$x##1178 &gt;= 0}</span><span class='hs-varid'>size</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1185 : (LHExercises.SList a) | lq_tmp$x##1185 == f##a1QAq}</span><span class='hs-varid'>f</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1190 : GHC.Types.Int | lq_tmp$x##1190 == (lq_anf$##7205759403793234520##d1QHC : int)}</span><span class='hs-num'>0</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1334 : a | $k_##1333[VV##1332:=lq_tmp$x##1334][lq_tmp$x##1331:=b##a1QAr]}</span><span class='hs-varid'>hd</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1336 : (LHExercises.SList a) | lq_tmp$x##1336 == b##a1QAr
                                          &amp;&amp; LHExercises.size lq_tmp$x##1336 == LHExercises.size f##a1QAq + 1}</span><span class='hs-varid'>b</span></a> <span class='hs-varop'>`cons`</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1352 : (LHExercises.SList a) | lq_tmp$x##1352 == acc##a1QAs}</span><span class='hs-varid'>acc</span></a>
<span class=hs-linenum>105: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1228 : a | $k_##1227[VV##1226:=lq_tmp$x##1228][lq_tmp$x##1225:=f##a1QAq]}</span><span class='hs-varid'>hd</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1230 : (LHExercises.SList a) | lq_tmp$x##1230 == f##a1QAq}</span><span class='hs-varid'>f</span></a> <span class='hs-varop'>`cons`</span> <a class=annot href="#"><span class=annottext>{v : (LHExercises.SList {lq_tmp$x##1299 : a | $k_##1298[VV##1297:=lq_tmp$x##1299][lq_tmp$x##1169:=lq_anf$##7205759403793234525##d1QHH][lq_tmp$x##1170:=lq_anf$##7205759403793234526##d1QHI][lq_tmp$x##1171:=lq_anf$##7205759403793234528##d1QHK]}) | LHExercises.size v == (LHExercises.size lq_anf$##7205759403793234525##d1QHH + LHExercises.size lq_anf$##7205759403793234526##d1QHI) + LHExercises.size lq_anf$##7205759403793234528##d1QHK}</span><span class='hs-varid'>rot</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1235 : (LHExercises.SList {lq_tmp$x##1240 : a | $k_##1239[VV##1238:=lq_tmp$x##1240][lq_tmp$x##1237:=f##a1QAq]}) | LHExercises.size lq_tmp$x##1235 == LHExercises.size f##a1QAq - 1}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>tl</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1242 : (LHExercises.SList a) | lq_tmp$x##1242 == f##a1QAq}</span><span class='hs-varid'>f</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1247 : (LHExercises.SList {lq_tmp$x##1252 : a | $k_##1251[VV##1250:=lq_tmp$x##1252][lq_tmp$x##1249:=b##a1QAr]}) | LHExercises.size lq_tmp$x##1247 == LHExercises.size b##a1QAr - 1}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>tl</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1254 : (LHExercises.SList a) | lq_tmp$x##1254 == b##a1QAr
                                          &amp;&amp; LHExercises.size lq_tmp$x##1254 == LHExercises.size f##a1QAq + 1}</span><span class='hs-varid'>b</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1271 : (LHExercises.SList {lq_tmp$x##1278 : a | $k_##1277[VV##1276:=lq_tmp$x##1278][lq_tmp$x##1274:=lq_anf$##7205759403793234527##d1QHJ][lq_tmp$x##1275:=acc##a1QAs]}) | LHExercises.size lq_tmp$x##1271 == LHExercises.size acc##a1QAs + 1}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##1263 : a | $k_##1262[VV##1261:=lq_tmp$x##1263][lq_tmp$x##1260:=b##a1QAr]}</span><span class='hs-varid'>hd</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1265 : (LHExercises.SList a) | lq_tmp$x##1265 == b##a1QAr
                                          &amp;&amp; LHExercises.size lq_tmp$x##1265 == LHExercises.size f##a1QAq + 1}</span><span class='hs-varid'>b</span></a> <span class='hs-varop'>`cons`</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1281 : (LHExercises.SList a) | lq_tmp$x##1281 == acc##a1QAs}</span><span class='hs-varid'>acc</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>106: </span><span class='hs-comment'>-- end Victor</span>
<span class=hs-linenum>107: </span><span class='hs-comment'>-- ##########</span>
<span class=hs-linenum>108: </span>
<span class=hs-linenum>109: </span><span class='hs-comment'>-- Safe remove</span>
<span class=hs-linenum>110: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>remove</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>qi</span><span class='hs-conop'>:</span><span class='hs-conid'>QueueN</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>{qsize qi}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{mq:</span> <span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>QueueN</span> <span class='hs-varid'>a</span> <span class='hs-layout'>{</span><span class='hs-varid'>qsize</span> <span class='hs-varid'>qi</span> <span class='hs-comment'>-</span> <span class='hs-num'>1</span><span class='hs-layout'>}</span><span class='hs-keyword'>) </span><span class='hs-keyglyph'>|</span> <span class='hs-varid'>qsize</span> <span class='hs-varid'>qi</span> <span class='hs-varop'>&gt;</span> <span class='hs-num'>0</span> <span class='hs-varop'>==&gt;</span> <span class='hs-varid'>isJust</span> <span class='hs-varid'>mq</span> <span class='hs-layout'>}</span><span class='hs-keyword'> </span><span class='hs-keyword'>@-}</span>
<span class=hs-linenum>111: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1485:(LHExercises.Queue a) -&gt; {mq : (GHC.Maybe.Maybe {VV##0 : (LHExercises.Queue a) | LHExercises.qsize VV##0 == LHExercises.qsize lq_tmp$x##1485 - 1}) | LHExercises.qsize lq_tmp$x##1485 &gt; 0 =&gt; isJust mq}</span><span class='hs-definition'>remove</span></a> <a class=annot href="#"><span class=annottext>(LHExercises.Queue a)</span><span class='hs-varid'>qi</span></a><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>Q</span> <span class='hs-varid'>f</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<span class=hs-linenum>112: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1516 : GHC.Types.Int | lq_tmp$x##1516 == LHExercises.size f##a1QAu
                                  &amp;&amp; lq_tmp$x##1516 &gt;= 0}</span><span class='hs-varid'>size</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1523 : (LHExercises.SList a) | lq_tmp$x##1523 == f##a1QAu}</span><span class='hs-varid'>f</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1528 : GHC.Types.Int | lq_tmp$x##1528 == (lq_anf$##7205759403793234540##d1QHW : int)}</span><span class='hs-num'>0</span></a> <span class='hs-varop'>&amp;&amp;</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1554 : GHC.Types.Int | lq_tmp$x##1554 == LHExercises.size b##a1QAv
                                  &amp;&amp; lq_tmp$x##1554 &gt;= 0}</span><span class='hs-varid'>size</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1561 : (LHExercises.SList a) | lq_tmp$x##1561 == b##a1QAv
                                          &amp;&amp; LHExercises.size lq_tmp$x##1561 &lt;= LHExercises.size f##a1QAu}</span><span class='hs-varid'>b</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1566 : GHC.Types.Int | lq_tmp$x##1566 == (lq_anf$##7205759403793234544##d1QI0 : int)}</span><span class='hs-num'>0</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##1656 : (GHC.Maybe.Maybe a) | not (isJust lq_tmp$x##1656)} | VV == GHC.Maybe.Nothing}</span><span class='hs-conid'>Nothing</span></a>
<span class=hs-linenum>113: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      lq_tmp$x##1641:a -&gt; {lq_tmp$x##1639 : (GHC.Maybe.Maybe a) | isJust lq_tmp$x##1639
                                                                  &amp;&amp; fromJust lq_tmp$x##1639 == lq_tmp$x##1641
                                                                  &amp;&amp; lqdc##$select##GHC.Maybe.Just##1 lq_tmp$x##1639 == lq_tmp$x##1641} | VV == GHC.Maybe.Just}</span><span class='hs-conid'>Just</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1624 : (LHExercises.Queue {lq_tmp$x##1631 : a | $k_##1630[VV##1629:=lq_tmp$x##1631][lq_tmp$x##1627:=lq_anf$##7205759403793234549##d1QI5][lq_tmp$x##1628:=b##a1QAv]}) | LHExercises.qsize lq_tmp$x##1624 == LHExercises.size lq_anf$##7205759403793234549##d1QI5 + LHExercises.size b##a1QAv}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>makeq</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1610 : (LHExercises.SList {lq_tmp$x##1615 : a | $k_##1614[VV##1613:=lq_tmp$x##1615][lq_tmp$x##1612:=f##a1QAu]}) | LHExercises.size lq_tmp$x##1610 == LHExercises.size f##a1QAu - 1}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>tl</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1617 : (LHExercises.SList a) | lq_tmp$x##1617 == f##a1QAu}</span><span class='hs-varid'>f</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1635 : (LHExercises.SList a) | lq_tmp$x##1635 == b##a1QAv
                                          &amp;&amp; LHExercises.size lq_tmp$x##1635 &lt;= LHExercises.size f##a1QAu}</span><span class='hs-varid'>b</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>114: </span>
<span class=hs-linenum>115: </span>
<span class=hs-linenum>116: </span><span class='hs-comment'>-- remove :: Queue a -&gt; Queue a</span>
<span class=hs-linenum>117: </span>
<span class=hs-linenum>118: </span><a class=annot href="#"><span class=annottext>(GHC.Maybe.Maybe (LHExercises.Queue GHC.Num.Integer.Integer))</span><span class='hs-definition'>okRemove</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>remove</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1675 : (LHExercises.Queue GHC.Num.Integer.Integer) | lq_tmp$x##1675 == LHExercises.example2Q
                                                                &amp;&amp; LHExercises.qsize lq_tmp$x##1675 == 2}</span><span class='hs-varid'>example2Q</span></a> <span class='hs-comment'>-- accept</span>
<span class=hs-linenum>119: </span>
<span class=hs-linenum>120: </span><a class=annot href="#"><span class=annottext>forall a . (GHC.Maybe.Maybe (LHExercises.Queue a))</span><span class='hs-definition'>badRemove</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>remove</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##1684 : (LHExercises.Queue a) | LHExercises.qsize lq_tmp$x##1684 == 0} | VV == LHExercises.example0Q}</span><span class='hs-varid'>example0Q</span></a> <span class='hs-comment'>-- reject</span>
<span class=hs-linenum>121: </span>
<span class=hs-linenum>122: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>emp</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>QueueN</span> <span class='hs-keyword'>_</span> <span class='hs-num'>0</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>123: </span><a class=annot href="#"><span class=annottext>forall a .
{VV##0 : (LHExercises.Queue a) | LHExercises.qsize VV##0 == 0}</span><span class='hs-definition'>emp</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Q</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##647 : (LHExercises.SList a) | LHExercises.size lq_tmp$x##647 == 0} | VV == LHExercises.nil}</span><span class='hs-varid'>nil</span></a> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##653 : (LHExercises.SList a) | LHExercises.size lq_tmp$x##653 == 0} | VV == LHExercises.nil}</span><span class='hs-varid'>nil</span></a>
<span class=hs-linenum>124: </span>
<span class=hs-linenum>125: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>example2Q</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>QueueN</span> <span class='hs-keyword'>_</span> <span class='hs-num'>2</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>126: </span><a class=annot href="#"><span class=annottext>{VV##0 : (LHExercises.Queue GHC.Num.Integer.Integer) | LHExercises.qsize VV##0 == 2}</span><span class='hs-definition'>example2Q</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Q</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##860 : (LHExercises.SList {lq_tmp$x##867 : GHC.Num.Integer.Integer | $k_##866[VV##865:=lq_tmp$x##867][lq_tmp$x##863:=lq_anf$##7205759403793234500##d1QHi][lq_tmp$x##864:=lq_anf$##7205759403793234503##d1QHl]}) | LHExercises.size lq_tmp$x##860 == LHExercises.size lq_anf$##7205759403793234503##d1QHl + 1}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##830 : GHC.Num.Integer.Integer | lq_tmp$x##830 == 1}</span><span class='hs-num'>1</span></a> <span class='hs-varop'>`cons`</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##844 : (LHExercises.SList {lq_tmp$x##851 : GHC.Num.Integer.Integer | $k_##850[VV##849:=lq_tmp$x##851][lq_tmp$x##847:=lq_anf$##7205759403793234501##d1QHj][lq_tmp$x##848:=lq_anf$##7205759403793234502##d1QHk]}) | LHExercises.size lq_tmp$x##844 == LHExercises.size lq_anf$##7205759403793234502##d1QHk + 1}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##832 : GHC.Num.Integer.Integer | lq_tmp$x##832 == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>`cons`</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##835 : (LHExercises.SList a) | LHExercises.size lq_tmp$x##835 == 0} | VV == LHExercises.nil}</span><span class='hs-varid'>nil</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##873 : (LHExercises.SList a) | LHExercises.size lq_tmp$x##873 == 0} | VV == LHExercises.nil}</span><span class='hs-varid'>nil</span></a>
<span class=hs-linenum>127: </span>
<span class=hs-linenum>128: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>example0Q</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>QueueN</span> <span class='hs-keyword'>_</span> <span class='hs-num'>0</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>129: </span><a class=annot href="#"><span class=annottext>forall a .
{VV##0 : (LHExercises.Queue a) | LHExercises.qsize VV##0 == 0}</span><span class='hs-definition'>example0Q</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Q</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##684 : (LHExercises.SList a) | LHExercises.size lq_tmp$x##684 == 0} | VV == LHExercises.nil}</span><span class='hs-varid'>nil</span></a> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##690 : (LHExercises.SList a) | LHExercises.size lq_tmp$x##690 == 0} | VV == LHExercises.nil}</span><span class='hs-varid'>nil</span></a>
<span class=hs-linenum>130: </span>
<span class=hs-linenum>131: </span><span class='hs-comment'>-- Exercise 9.4</span>
<span class=hs-linenum>132: </span><span class='hs-comment'>--</span></pre>
</body>
</html>